version: 7.4.{build}

branches:
  only:
  - master
  - appveyor
  
skip_tags: true

image:
- Visual Studio 2019
- Ubuntu2004

environment:
  data_folder: '%APPVEYOR_BUILD_FOLDER%\data'
  project_folder: '%APPVEYOR_BUILD_FOLDER%\\src'
  dependency_folder: '%APPVEYOR_BUILD_FOLDER%\dependencies'

install:
  - git submodule init
  - git submodule update
  - cmd: '%APPVEYOR_BUILD_FOLDER%\.appveyor\Install.bat'
  - sh: '${APPVEYOR_BUILD_FOLDER}/.appveyor/Install.sh'

build_script:
  - cmd: '%APPVEYOR_BUILD_FOLDER%\.appveyor\Build.bat'
  - sh: '${APPVEYOR_BUILD_FOLDER}/.appveyor/Build.sh'

after_build:
  - cmd: '%APPVEYOR_BUILD_FOLDER%\.appveyor\AfterBuild.bat'
  - sh: '${APPVEYOR_BUILD_FOLDER}/.appveyor/AfterBuild.sh'

cache:
#  - 'src\obj\'
  
artifacts:
  - path: .build\build\*.zip
    name: Windows Binaries

  - path: .build\build\*.tar.gz
    name: Linux Binaries
  
  - path: io.github.opendriver2.Redriver2.flatpak
    name: Linux Flatpak
